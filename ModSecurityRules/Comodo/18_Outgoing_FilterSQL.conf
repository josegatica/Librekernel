# ---------------------------------------------------------------
# Comodo ModSecurity Rules
# Copyright (C) 2017 Comodo Security solutions All rights reserved.
#
# The COMODO SECURITY SOLUTIONS Mod Security Rule Set is distributed under
# THE COMODO SECURITY SOLUTIONS END USER LICENSE AGREEMENT,
# Please see the enclosed LICENCE file for full details.
# ---------------------------------------------------------------
# This is a FILE CONTAINING CHANGED or MODIFIED RULES FROM THE:
# OWASP ModSecurity Core Rule Set (CRS)
# ---------------------------------------------------------------

SecRule RESPONSE_BODY "(?:\b(?:Access Database Engine|JET Database Engine|Microsoft Access Driver|Npgsql.|ORA-[0-9]{5,5}: |ORA-[0-9][0-9][0-9][0-9]|Oracle error|Oracle.{0,}?Driver|PostgreSQL query failed:|PostgreSQL.{0,}?ERROR|Un(?:able to connect to PostgreSQL server:|closed quotation mark before the character string\b)|Warning.{0,}?Woci_.{0,}?|Warning.{0,}?Wora_.{0,}?|Warning.{0,}?Wpg_.{0,}?|Warning: mysql_connect\(\):|You have an error in your SQL syntax(?: near '){0,1}|cannot take a [a-zA-Z0-9_]{1,} data type as an argument\.|incorrect syntax near (?:'|@@error\b|the\b)|microsoft jet database engine error '8|valid PostgreSQL result|(?:Microsoft OLE DB Provider for .{0,30} [Ee]rror |error '800a01b8)'|(?:Could not find server '[a-zA-Z0-9_]{1,}' in sysservers\. execute sp_addlinkedserver|Either BOF or EOF is True, or the current record has been deleted(; the operation|. Requested)|S(?:QL Server does not exist or access denied|yntax error converting the [a-zA-Z0-9_]{1,} value .{0,}? to a column of data type)|The column prefix .{0,50}? does not match with a table name or alias name used in the query|s(?:elect list because it is not contained in (?:an aggregate function and there is no|either an aggregate function or the) GROUP BY clause|upplied argument is not a valid (?:M(?:S |y)SQL|O(?:DBC|racle)|PostgreSQL result)))\b)|Driver.{0,}? SQL[ \-_]{0,}Server|Exception Details:.{0,}?WSystem.Data.SqlClient.|Exception Details:.{0,}?WRoadhouse.Cms.|MySqlClient.|OLE DB.{0,}? SQL Server|SQL syntax.{0,}?MySQL|SQLite/JDBCDriver|SQLite.Exception|System.Data.SQLite.SQLiteException|Warning.{0,}?mssql_.{0,}?|Warning.{0,}?mysql_.{0,}?|Warning.{0,}?sqlite_.{0,}?|Warning.{0,}?SQLite3::|\[Microsoft]\[ODBC |valid MySQL result|(A|W)SQL Server.{0,}?Driver|(A|W)SQL Server.{0,}?[0-9ABCDEFabcdef]{8,8})" \
	"id:214650,msg:'COMODO WAF: SQL Information Leakage||%{tx.domain}|%{tx.mode}|2',phase:4,capture,block,setvar:'tx.outgoing_points=+%{tx.points_limit4}',setvar:'tx.points=+%{tx.points_limit4}',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',ctl:auditLogParts=+E,t:none,rev:1,severity:2"

